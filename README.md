# РУКОВОДСТВО ПО ИСПОЛЬЗОВАНИЮ СКРИПТА
___
## 1. Назначение
Скрипт написан для парсинга (разбора) файла выгрузки данных в формате .xml и создания на его основе машиночитаемой карты сайта.

## 2. Порядок работы
### 2.1. Запуск скрипта
Запускается из командной строки. Возможно, потребуется установить разрешение на исполнение файла.

### 2.2. Аргументы скрипта
Все аргументы передаются как ключевые.

**Обязательные аргументы:**

**-f** - путь к файлу выгрузки, абсолютный или относительный, в т.ч. "вверх" по дереву. Файл может быть в архиве '.gz'.

**-t** - тег (или группа тегов через пробел), который нужно найти в файле выгрузки.
Их текст будет включен в подтег "loc" тега "url" карты сайта. О формате передаваемых аргументов тега сказано ниже.

**Опциональные аргументы:**

**-o** - путь к папке вывода файлов карты сайта - абсолютный или относительный.
Если папка не существует, то будет создана. Значение по умолчанию - 'sitemap' в текущем каталоге.

**-a** - количество записей на один файл карты сайте. Значение по умолчанию - 50000.
В случае, если найдено больше записей, создается следующий файл карты сайта, а также файл индекса карт сайта.

**-u** - приоритет страниц, указываемый в карте сайта. Значение по умолчанию - 0.3

**-p** - префикс имени файлов карты сайта. Значение по умолчанию - 'sitemap'.
При создании нескольких файлов к префиксу автоматически добавляется порядковый номер.

**-z** - нужно ли дополнительно создать архивы с файлами карты сайта. Формат - '.gz'. Размещение в той же папке.

**-r** - нужно ли вывести на экран отчет. Выводится затраченное время, количество обработанных тегов, информация о файлах
и папке их размещения. Найденный тег считается обработанным, только если он содержал текст для включения в url карты сайта

### 2.3. Способы указания аргументов целевых тегов
Для ограничения области поиска тегов в файле выгрузки следует указывать их в формате выражений XPath.
___

Например, структура файла выгрузки такова:

 ```
   <yml_catalog date="2021-01-13 19:02"> # КОРЕНЬ
      <shop>
        <name>ЗИП &#34;МАГАЗИН ЗАПЧАСТЕЙ&#34;</name>
        <company>ЗИП &#34;МАГАЗИН ЗАПЧАСТЕЙ&#34;</company>
   
        <url>https://zip.ru</url>
   
        <offers>
   
          <url>https://test.ru</url>
   
          <offer>
            <url>https://zip77.ru/parts/25?d=327</url>
            <picture>https://pubimg.4mycar.ru/images/20005.png</picture>
          </offer>
   
          <offer>
            <url>https://zip77.ru/parts/26?d=327</url>
            <picture>https://pubimg.4mycar.ru/images/10005.jpeg</picture>
          </offer>
   
        </offers>
      </shop>
    </yml_catalog>
```

Примеры указания путей (кавычки не нужны при указании аргументов) и результаты поиска:
- **'url'** - все **url** (прямые потомки) **в текущем узле** (т.к. по логике скрипта поиск ведется от корня, то не найдет ничего)
- **'/url'** - все **url** (прямые потомки) **в корневом узле** ('/' в начале означает корень, т.е. тоже не найдет ничего)
- **'shop/url'** - все **url** (прямые потомки) в узле **shop**, который прямой потомок корня (т.е. найдет ```https://zip.ru```)
- **'//url'** - все **url** (независимо от вложенности) в **дереве** (```https://zip.ru, https://test.ru,
https://zip77.ru/parts/25?d=327, https://zip77.ru/parts/26?d=327```)
- **'//offers/url'** - все **url** (прямые потомки) в узле **offers** (независимо от вложенности) в дереве
(т.е. найдет ```https://test.ru```)
- **'//offers//url'** - все **url** (независимо от вложенности) в **offers** (независимо от вложенности) в дереве
(т.е. найдет ```https://test.ru, https://zip77.ru/parts/25?d=327, https://zip77.ru/parts/26?d=327```)
- **'//url //picture'** - все **url** и все **picture** в **дереве**
